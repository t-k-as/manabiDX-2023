# 工場の製造不良部品（回路基板の半田不良）を検出する画像認識モデル

## 概要
  * カメラで撮影したJPEG画像をResNet101で良品/不良品（2クラス）に分類
  * 初めて画像認識モデルを使ってコンペティションに参加
  * 最終結果は13位（本教材に約500名参加）

## 工夫したポイント
  * チューニングによる試行回数を稼ぐことを重視。オンプレミス環境でRTX3060Super(4GB)の制限あり。
    モデルはRedNet101を採用。101以上は精度アップ小　かつ　メモリスワップで学習データロードに時間がかかったため採用見送り。
  * パラメタチューニング毎の精度管理とFN/FPの画像出力（分析用）を一元管理するために、Tensorboardを使用。
  * 最終局面では「Kaggleに挑む深層学習プログラミングの極意」でテクニックを調査し、CrossValidationを実装。

## 解法 
### 前処理
  * 写真から基板部分を切り出し
  * CLAHEで局所コントラスト調整
  * 画像サイズを224×224にリサイズ

### モデル学習
  * ResNet101を採用
  * 5-foldのCross Validationで5個の学習モデルを作成（アンサンブル学習）
  * Deta Augumentationで学習画像を水増し
  * スケジューラを使用し、学習率をepoch毎に調整（CosineAnnealingLRを使用）

### 推論
  * 5個の学習済みモデルにテストデータを入力し、各推論の予測値（確率）を収集
  * 各モデルの予測値の平均を求め、四捨五入して予測結果を求める
  
### 後処理
  * 特になし

## 使用ライブラリ
  * numpy
  * pandas
  * matplotlib
  * sklearn
  * datetime
  * seaborn
  * OpeCV
  * PIL
  * tqdm
  * torch
  * torchvision
  * tensorboard
